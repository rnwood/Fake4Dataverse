(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,75570,e=>{"use strict";e.s(["default",()=>Y],75570);var a=e.i(43476),l=e.i(71645),t=e.i(76166),i=e.i(83831),o=e.i(77790),r=e.i(50637),n=e.i(90885),s=e.i(87452),c=e.i(47427),d=e.i(84862),m=e.i(39806);let u=(0,m.createFluentIcon)("Folder20Regular","20",["M4.5 3A2.5 2.5 0 0 0 2 5.5v9A2.5 2.5 0 0 0 4.5 17h11a2.5 2.5 0 0 0 2.5-2.5v-7A2.5 2.5 0 0 0 15.5 5H9.7L8.23 3.51A1.75 1.75 0 0 0 6.98 3H4.5ZM3 5.5C3 4.67 3.67 4 4.5 4h2.48c.2 0 .4.08.53.22L8.8 5.5 7.44 6.85a.5.5 0 0 1-.35.15H3V5.5ZM3 8h4.09c.4 0 .78-.16 1.06-.44L9.7 6h5.79c.83 0 1.5.67 1.5 1.5v7c0 .83-.67 1.5-1.5 1.5h-11A1.5 1.5 0 0 1 3 14.5V8Z"]),h=(0,m.createFluentIcon)("FolderOpen20Regular","20",["M3 5.5v6.6l1.5-2.6A3 3 0 0 1 7.1 8H15v-.5c0-.83-.67-1.5-1.5-1.5h-4a.5.5 0 0 1-.35-.15l-1.71-1.7A.5.5 0 0 0 7.09 4H4.5C3.67 4 3 4.67 3 5.5Zm1.28 10.48.22.02h9.4a2 2 0 0 0 1.73-1l2.17-3.75A1.5 1.5 0 0 0 16.5 9H7.1a2 2 0 0 0-1.73 1L3.2 13.75a1.5 1.5 0 0 0 1.08 2.23ZM2 14.46V5.5A2.5 2.5 0 0 1 4.5 3h2.59c.4 0 .78.16 1.06.44L9.7 5h3.79A2.5 2.5 0 0 1 16 7.5V8h.5a2.5 2.5 0 0 1 2.16 3.75L16.5 15.5a3 3 0 0 1-2.6 1.5H4.5a2.54 2.54 0 0 1-1.62-.6A2.5 2.5 0 0 1 2 14.46Z"],{flipInRtl:!0}),p=(0,m.createFluentIcon)("Table20Regular","20",["M17 5.5A2.5 2.5 0 0 0 14.5 3h-9A2.5 2.5 0 0 0 3 5.5v9A2.5 2.5 0 0 0 5.5 17h9a2.5 2.5 0 0 0 2.5-2.5v-9Zm-13 9V13h3v3H5.36A1.5 1.5 0 0 1 4 14.5Zm8-1.5v3H8v-3h4Zm2.5 3H13v-3h3V14.64A1.5 1.5 0 0 1 14.5 16ZM12 8v4H8V8h4Zm1 0h3v4h-3V8Zm-1-4v3H8V4h4Zm1 0H14.64A1.5 1.5 0 0 1 16 5.5V7h-3V4ZM7 4v3H4V5.36A1.5 1.5 0 0 1 5.5 4H7Zm0 4v4H4V8h3Z"]),x=(0,t.makeStyles)({nav:{width:"300px",height:"100vh",backgroundColor:i.tokens.colorNeutralBackground3,borderRight:"1px solid ".concat(i.tokens.colorNeutralStroke1),display:"flex",flexDirection:"column",overflow:"hidden"},header:{padding:"16px",borderBottom:"1px solid ".concat(i.tokens.colorNeutralStroke1),fontWeight:i.tokens.fontWeightSemibold,fontSize:i.tokens.fontSizeBase400},scrollArea:{flex:1,overflow:"auto",padding:"8px"},tableItem:{cursor:"pointer"},selectedTableItem:{backgroundColor:i.tokens.colorNeutralBackground1Selected}});function b(e){let{solutions:t,tables:i,selectedTable:o,onTableSelect:r}=e,n=x(),[m,b]=(0,l.useState)(new Set),N=[{solutionid:"fd140aaf-4df4-11dd-bd17-0019b9312238",uniquename:"Active",friendlyname:"Active",ismanaged:!1,isvisible:!0},...t];return(0,a.jsxs)("div",{className:n.nav,children:[(0,a.jsx)("div",{className:n.header,children:"Solutions & Tables"}),(0,a.jsx)("div",{className:n.scrollArea,children:(0,a.jsx)(s.Tree,{"aria-label":"Solutions and tables",openItems:m,onOpenChange:(e,a)=>{b(a.openItems)},children:N.map(e=>(0,a.jsxs)(c.TreeItem,{itemType:"branch",value:e.solutionid,children:[(0,a.jsxs)(d.TreeItemLayout,{iconBefore:m.has(e.solutionid)?(0,a.jsx)(h,{}):(0,a.jsx)(u,{}),children:[e.friendlyname||e.uniquename,"Active"===e.uniquename&&" (All Components)"]}),(0,a.jsx)(s.Tree,{children:i.map(l=>{var t,i;return(0,a.jsx)(c.TreeItem,{itemType:"leaf",value:"".concat(e.solutionid,"-").concat(l.LogicalName),children:(0,a.jsx)(d.TreeItemLayout,{iconBefore:(0,a.jsx)(p,{}),className:o===l.LogicalName?"".concat(n.tableItem," ").concat(n.selectedTableItem):n.tableItem,onClick:()=>{r(l.LogicalName)},children:(null==(i=l.DisplayName)||null==(t=i.UserLocalizedLabel)?void 0:t.Label)||l.SchemaName||l.LogicalName})},"".concat(e.solutionid,"-").concat(l.LogicalName))})})]},e.solutionid))})})]})}var N=e.i(86907),g=e.i(22053),v=e.i(46036),f=e.i(38120),j=e.i(82267),y=e.i(68748),C=e.i(84019),L=e.i(54902);let S=(0,t.makeStyles)({container:{display:"flex",flexDirection:"column",height:"100%",padding:"16px",overflow:"hidden"},header:{marginBottom:"16px"},title:{fontSize:i.tokens.fontSizeBase500,fontWeight:i.tokens.fontWeightSemibold,marginBottom:"8px"},searchBox:{maxWidth:"400px"},tableContainer:{flex:1,overflow:"auto",border:"1px solid ".concat(i.tokens.colorNeutralStroke1),borderRadius:i.tokens.borderRadiusMedium},tableRow:{cursor:"pointer","&:hover":{backgroundColor:i.tokens.colorNeutralBackground1Hover}}});function k(e){let{tables:t,onTableSelect:i}=e,o=S(),[r,n]=(0,l.useState)(""),s=(0,l.useMemo)(()=>{if(!r.trim())return t;let e=r.toLowerCase();return t.filter(a=>{var l,t,i,o;let r=(null==(i=a.DisplayName)||null==(t=i.UserLocalizedLabel)||null==(l=t.Label)?void 0:l.toLowerCase())||"",n=a.LogicalName.toLowerCase(),s=(null==(o=a.SchemaName)?void 0:o.toLowerCase())||"";return r.includes(e)||n.includes(e)||s.includes(e)})},[t,r]);return(0,a.jsxs)("div",{className:o.container,children:[(0,a.jsxs)("div",{className:o.header,children:[(0,a.jsx)("div",{className:o.title,children:"Tables"}),(0,a.jsx)(N.Input,{className:o.searchBox,contentBefore:(0,a.jsx)(L.Search20Regular,{}),placeholder:"Search tables...",value:r,onChange:(e,a)=>n(a.value)})]}),(0,a.jsx)("div",{className:o.tableContainer,children:(0,a.jsxs)(g.Table,{size:"small",children:[(0,a.jsx)(y.TableHeader,{children:(0,a.jsxs)(j.TableRow,{children:[(0,a.jsx)(C.TableHeaderCell,{children:"Display Name"}),(0,a.jsx)(C.TableHeaderCell,{children:"Logical Name"}),(0,a.jsx)(C.TableHeaderCell,{children:"Schema Name"}),(0,a.jsx)(C.TableHeaderCell,{children:"Plural Name"}),(0,a.jsx)(C.TableHeaderCell,{children:"Custom"})]})}),(0,a.jsx)(v.TableBody,{children:s.map(e=>{var l,t,r,n;return(0,a.jsxs)(j.TableRow,{className:o.tableRow,onClick:()=>i(e.LogicalName),children:[(0,a.jsx)(f.TableCell,{children:(null==(t=e.DisplayName)||null==(l=t.UserLocalizedLabel)?void 0:l.Label)||e.SchemaName||e.LogicalName}),(0,a.jsx)(f.TableCell,{children:e.LogicalName}),(0,a.jsx)(f.TableCell,{children:e.SchemaName||""}),(0,a.jsx)(f.TableCell,{children:(null==(n=e.DisplayCollectionName)||null==(r=n.UserLocalizedLabel)?void 0:r.Label)||""}),(0,a.jsx)(f.TableCell,{children:e.IsCustomEntity?"Yes":"No"})]},e.LogicalName)})})]})})]})}var T=e.i(85182),A=e.i(51345),I=e.i(59066),w=e.i(31131);let B=(0,t.makeStyles)({tableContainer:{border:"1px solid ".concat(i.tokens.colorNeutralStroke1),borderRadius:i.tokens.borderRadiusMedium,overflow:"auto"},propertyName:{fontWeight:i.tokens.fontWeightSemibold,width:"40%",backgroundColor:i.tokens.colorNeutralBackground3},propertyValue:{width:"60%"},emptyValue:{fontStyle:"italic",color:i.tokens.colorNeutralForeground3}});function D(e){let{properties:l}=e,t=B();return(0,a.jsx)("div",{className:t.tableContainer,children:(0,a.jsxs)(g.Table,{size:"small",children:[(0,a.jsx)(y.TableHeader,{children:(0,a.jsxs)(j.TableRow,{children:[(0,a.jsx)(C.TableHeaderCell,{className:t.propertyName,children:"Property"}),(0,a.jsx)(C.TableHeaderCell,{className:t.propertyValue,children:"Value"})]})}),(0,a.jsx)(v.TableBody,{children:Object.entries(l).map(e=>{let[l,i]=e;return(0,a.jsxs)(j.TableRow,{children:[(0,a.jsx)(f.TableCell,{className:t.propertyName,children:l}),(0,a.jsx)(f.TableCell,{className:t.propertyValue,children:i||(0,a.jsx)("span",{className:t.emptyValue,children:"(empty)"})})]},l)})})]})})}var H=e.i(87194),R=e.i(40454),V=e.i(88544),P=e.i(40894),z=e.i(98358);let E=(0,t.makeStyles)({container:{display:"flex",flexDirection:"column",gap:"8px"},columnHeader:{display:"flex",alignItems:"center",gap:"8px"},badge:{marginLeft:"8px"}});function Z(e){let{columns:l}=e,t=E();return(0,a.jsx)("div",{className:t.container,children:(0,a.jsx)(H.Accordion,{multiple:!0,collapsible:!0,children:l.map(e=>{var l,i,o,r,n,s,c,d;return(0,a.jsxs)(R.AccordionItem,{value:e.LogicalName,children:[(0,a.jsx)(V.AccordionHeader,{children:(0,a.jsxs)("div",{className:t.columnHeader,children:[(0,a.jsx)("span",{children:(null==(i=e.DisplayName)||null==(l=i.UserLocalizedLabel)?void 0:l.Label)||e.SchemaName||e.LogicalName}),e.IsCustomAttribute&&(0,a.jsx)(z.Badge,{appearance:"filled",color:"brand",className:t.badge,children:"Custom"}),e.IsPrimaryId&&(0,a.jsx)(z.Badge,{appearance:"filled",color:"important",className:t.badge,children:"Primary ID"}),e.IsPrimaryName&&(0,a.jsx)(z.Badge,{appearance:"filled",color:"informative",className:t.badge,children:"Primary Name"})]})}),(0,a.jsx)(P.AccordionPanel,{children:(0,a.jsx)(D,{properties:{"Logical Name":e.LogicalName,"Schema Name":e.SchemaName||"","Display Name":(null==(r=e.DisplayName)||null==(o=r.UserLocalizedLabel)?void 0:o.Label)||"",Description:(null==(s=e.Description)||null==(n=s.UserLocalizedLabel)?void 0:n.Label)||"","Attribute Type":(null==(c=e.AttributeTypeName)?void 0:c.Value)||e.AttributeType||"","Is Custom":e.IsCustomAttribute?"Yes":"No","Is Primary ID":e.IsPrimaryId?"Yes":"No","Is Primary Name":e.IsPrimaryName?"Yes":"No","Required Level":(null==(d=e.RequiredLevel)?void 0:d.Value)||""}})})]},e.LogicalName)})})})}let M=(0,t.makeStyles)({container:{display:"flex",flexDirection:"column",gap:"8px"},formHeader:{display:"flex",alignItems:"center",gap:"8px"},badge:{marginLeft:"8px"}}),F={0:"Dashboard",1:"AppointmentBook",2:"Main",4:"Quick Create",5:"Quick View Read-Only",6:"Quick View",7:"Dialog",8:"Task Flow",9:"InteractionCentric",11:"Card",12:"Main - Interactive experience"};function U(e){let{forms:l}=e,t=M(),i=e=>F[e]||"Type ".concat(e);return(0,a.jsx)("div",{className:t.container,children:(0,a.jsx)(H.Accordion,{multiple:!0,collapsible:!0,children:l.map(e=>{var l;return(0,a.jsxs)(R.AccordionItem,{value:e.formid,children:[(0,a.jsx)(V.AccordionHeader,{children:(0,a.jsxs)("div",{className:t.formHeader,children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)(z.Badge,{appearance:"outline",className:t.badge,children:i(e.type)}),e.isdefault&&(0,a.jsx)(z.Badge,{appearance:"filled",color:"success",className:t.badge,children:"Default"})]})}),(0,a.jsx)(P.AccordionPanel,{children:(0,a.jsx)(D,{properties:{"Form ID":e.formid,Name:e.name,Type:i(e.type),Description:e.description||"","Is Default":e.isdefault?"Yes":"No",Entity:e.objecttypecode,State:0===e.statecode?"Active":"Inactive",Status:(null==(l=e.statuscode)?void 0:l.toString())||""}})})]},e.formid)})})})}let O=(0,t.makeStyles)({container:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},toolbar:{display:"flex",alignItems:"center",gap:"12px",padding:"16px",borderBottom:"1px solid ".concat(i.tokens.colorNeutralStroke1)},title:{fontSize:i.tokens.fontSizeBase500,fontWeight:i.tokens.fontWeightSemibold},tabs:{padding:"0 16px",borderBottom:"1px solid ".concat(i.tokens.colorNeutralStroke1)},content:{flex:1,overflow:"auto",padding:"16px"},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},errorContainer:{padding:"24px",color:i.tokens.colorPaletteRedForeground1}});function W(e){var t,i,n,s,c,d,m,u,h;let{logicalName:p,onBack:x}=e,b=O(),[N,g]=(0,l.useState)(!0),[v,f]=(0,l.useState)(null),[j,y]=(0,l.useState)(null),[C,L]=(0,l.useState)([]),[S,k]=(0,l.useState)([]),[B,H]=(0,l.useState)("properties");(0,l.useEffect)(()=>{R()},[p]);let R=async()=>{try{g(!0),f(null);let e=await w.dataverseClient.fetchEntityDefinition(p,{expand:["Attributes"]});y(e),L(e.Attributes||[]);let a=await w.dataverseClient.fetchEntities("systemforms",{filter:"objecttypecode eq '".concat(p,"'"),select:["formid","name","type","description","isdefault"],orderby:"name asc"});k(a.value),g(!1)}catch(e){console.error("Error loading table details:",e),f(e instanceof Error?e.message:"Failed to load table details"),g(!1)}};return N?(0,a.jsx)("div",{className:b.loadingContainer,children:(0,a.jsx)(o.Spinner,{size:"large",label:"Loading table details..."})}):v?(0,a.jsxs)("div",{className:b.errorContainer,children:[(0,a.jsx)("h2",{children:"Error"}),(0,a.jsx)("p",{children:v}),(0,a.jsx)(r.Button,{onClick:x,children:"Back to Tables"})]}):(0,a.jsxs)("div",{className:b.container,children:[(0,a.jsxs)("div",{className:b.toolbar,children:[(0,a.jsx)(r.Button,{icon:(0,a.jsx)(I.ArrowLeft20Regular,{}),appearance:"subtle",onClick:x,children:"Back"}),(0,a.jsx)("div",{className:b.title,children:j&&((null==(i=j.DisplayName)||null==(t=i.UserLocalizedLabel)?void 0:t.Label)||j.SchemaName)||p})]}),(0,a.jsx)("div",{className:b.tabs,children:(0,a.jsxs)(T.TabList,{selectedValue:B,onTabSelect:(e,a)=>H(a.value),children:[(0,a.jsx)(A.Tab,{value:"properties",children:"Properties"}),(0,a.jsxs)(A.Tab,{value:"columns",children:["Columns (",C.length,")"]}),(0,a.jsxs)(A.Tab,{value:"forms",children:["Forms (",S.length,")"]})]})}),(0,a.jsxs)("div",{className:b.content,children:["properties"===B&&(0,a.jsx)(D,{properties:j?{"Logical Name":j.LogicalName||"","Schema Name":j.SchemaName||"","Display Name":(null==(s=j.DisplayName)||null==(n=s.UserLocalizedLabel)?void 0:n.Label)||"","Plural Name":(null==(d=j.DisplayCollectionName)||null==(c=d.UserLocalizedLabel)?void 0:c.Label)||"",Description:(null==(u=j.Description)||null==(m=u.UserLocalizedLabel)?void 0:m.Label)||"","Entity Set Name":j.EntitySetName||"","Primary ID Attribute":j.PrimaryIdAttribute||"","Primary Name Attribute":j.PrimaryNameAttribute||"","Object Type Code":(null==(h=j.ObjectTypeCode)?void 0:h.toString())||"","Is Custom Entity":j.IsCustomEntity?"Yes":"No","Is Activity":j.IsActivity?"Yes":"No","Ownership Type":j.OwnershipType||""}:{}}),"columns"===B&&(0,a.jsx)(Z,{columns:C}),"forms"===B&&(0,a.jsx)(U,{forms:S})]})]})}let q=(0,t.makeStyles)({container:{display:"flex",height:"100vh",overflow:"hidden"},main:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},toolbar:{display:"flex",alignItems:"center",gap:"12px",padding:"8px 16px",borderBottom:"1px solid ".concat(i.tokens.colorNeutralStroke1),backgroundColor:i.tokens.colorNeutralBackground3},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",backgroundColor:i.tokens.colorNeutralBackground1},errorContainer:{padding:"24px",color:i.tokens.colorPaletteRedForeground1,backgroundColor:i.tokens.colorNeutralBackground1}});function Y(){let e=q(),[t,i]=(0,l.useState)([]),[s,c]=(0,l.useState)([]),[d,m]=(0,l.useState)(!0),[u,h]=(0,l.useState)(null),[p,x]=(0,l.useState)(null),[N,g]=(0,l.useState)("browser");(0,l.useEffect)(()=>{v()},[]);let v=async()=>{try{m(!0);let e=await w.dataverseClient.fetchEntities("solutions",{select:["solutionid","uniquename","friendlyname","version","ismanaged"],orderby:"friendlyname asc"});i(e.value);let a=await w.dataverseClient.fetchEntityDefinitions({select:["MetadataId","LogicalName","SchemaName","DisplayName","DisplayCollectionName","EntitySetName","IsCustomEntity"]});c(a.value||[]),m(!1)}catch(e){console.error("Error loading make data:",e),h(e instanceof Error?e.message:"Failed to load data"),m(!1)}},f=e=>{x(e),g("detail")};return d?(0,a.jsx)("div",{className:e.loadingContainer,children:(0,a.jsx)(o.Spinner,{size:"large",label:"Loading solutions and tables..."})}):u?(0,a.jsxs)("div",{className:e.errorContainer,children:[(0,a.jsx)("h2",{children:"Error"}),(0,a.jsx)("p",{children:u})]}):(0,a.jsxs)("div",{className:e.container,children:[(0,a.jsx)(b,{solutions:t,tables:s,selectedTable:p,onTableSelect:f}),(0,a.jsxs)("main",{className:e.main,children:[(0,a.jsx)("div",{className:e.toolbar,children:(0,a.jsx)(r.Button,{appearance:"subtle",icon:(0,a.jsx)(n.Home20Regular,{}),onClick:()=>{window.location.href="/"},children:"Back to App"})}),"browser"===N&&(0,a.jsx)(k,{tables:s,onTableSelect:f}),"detail"===N&&p&&(0,a.jsx)(W,{logicalName:p,onBack:()=>{g("browser"),x(null)}})]})]})}}]);