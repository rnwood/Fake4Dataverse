"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[288],{3113:(e,t,i)=>{let s;i.d(t,{$d:()=>eF,K9:()=>h,LF:()=>c,S:()=>eC,U6:()=>et,VB:()=>C,_A:()=>eT,gm:()=>k,h7:()=>n,hC:()=>ek,iA:()=>u,uH:()=>d});var r=i(7291);let n="data-tabster",o="a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), *[tabindex], *[contenteditable], details > summary, audio[controls], video[controls]",l={EscapeGroupper:1,Restorer:2,Deloser:3},a={Invisible:0,PartiallyVisible:1,Visible:2},u={Both:0,Vertical:1,Horizontal:2,Grid:3,GridLinear:4},d={ArrowUp:1,ArrowDown:2,ArrowLeft:3,ArrowRight:4,PageUp:5,PageDown:6,Home:7,End:8},h={Unlimited:0,Limited:1,LimitedTrapFocus:2},c={Enter:1,Escape:2},m={Outside:2};function _(e,t){var i;return null==(i=e.storageEntry(t))?void 0:i.tabster}function f(e,t,i){var s,r;let o,l=i||e._noop?void 0:t.getAttribute(n),a=e.storageEntry(t);if(l)if(l===(null==(s=null==a?void 0:a.attr)?void 0:s.string))return;else try{let e=JSON.parse(l);if("object"!=typeof e)throw Error(`Value is not a JSON object, got '${l}'.`);o={string:l,object:e}}catch(e){}else if(!a)return;a||(a=e.storageEntry(t,!0)),a.tabster||(a.tabster={});let u=a.tabster||{},d=(null==(r=a.attr)?void 0:r.object)||{},h=(null==o?void 0:o.object)||{};for(let i of Object.keys(d))if(!h[i]){if("root"===i){let t=u[i];t&&e.root.onRoot(t,!0)}switch(i){case"deloser":case"root":case"groupper":case"modalizer":case"restorer":case"mover":let s=u[i];s&&(s.dispose(),delete u[i]);break;case"observed":delete u[i],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete u[i]}}for(let i of Object.keys(h)){let s=h.sys;switch(i){case"deloser":u.deloser?u.deloser.setProps(h.deloser):e.deloser&&(u.deloser=e.deloser.createDeloser(t,h.deloser));break;case"root":u.root?u.root.setProps(h.root):u.root=e.root.createRoot(t,h.root,s),e.root.onRoot(u.root);break;case"modalizer":u.modalizer?u.modalizer.setProps(h.modalizer):e.modalizer&&(u.modalizer=e.modalizer.createModalizer(t,h.modalizer,s));break;case"restorer":u.restorer?u.restorer.setProps(h.restorer):e.restorer&&h.restorer&&(u.restorer=e.restorer.createRestorer(t,h.restorer));break;case"focusable":u.focusable=h.focusable;break;case"groupper":u.groupper?u.groupper.setProps(h.groupper):e.groupper&&(u.groupper=e.groupper.createGroupper(t,h.groupper,s));break;case"mover":u.mover?u.mover.setProps(h.mover):e.mover&&(u.mover=e.mover.createMover(t,h.mover,s));break;case"observed":e.observedElement&&(u.observed=h.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":u.uncontrolled=h.uncontrolled;break;case"outline":e.outline&&(u.outline=h.outline);break;case"sys":u.sys=h.sys;break;default:console.error(`Unknown key '${i}' in data-tabster attribute value.`)}}o?a.attr=o:(0===Object.keys(u).length&&(delete a.tabster,delete a.attr),e.storageEntry(t,!1))}let b="tabster:mover:movefocus",p="tabster:mover:memorized-element",v="tabster:groupper:movefocus",g="undefined"!=typeof CustomEvent?CustomEvent:function(){};class E extends g{constructor(e,t){super(e,{bubbles:!0,cancelable:!0,composed:!0,detail:t}),this.details=t}}class w extends E{constructor(e){super("tabster:focusin",e)}}class y extends E{constructor(e){super("tabster:focusout",e)}}class T extends E{constructor(e){super("tabster:movefocus",e)}}class F extends E{constructor(e){super("tabster:mover:state",e)}}class C extends E{constructor(e){super(b,e)}}class k extends E{constructor(e){super(v,e)}}class I extends E{constructor(e){super("tabster:root:focus",e)}}class O extends E{constructor(e){super("tabster:root:blur",e)}}let D={createMutationObserver:e=>new MutationObserver(e),createTreeWalker:(e,t,i,s)=>e.createTreeWalker(t,i,s),getParentNode:e=>e?e.parentNode:null,getParentElement:e=>e?e.parentElement:null,nodeContains:(e,t)=>!!(t&&(null==e?void 0:e.contains(t))),getActiveElement:e=>e.activeElement,querySelector:(e,t)=>e.querySelector(t),querySelectorAll:(e,t)=>Array.prototype.slice.call(e.querySelectorAll(t),0),getElementById:(e,t)=>e.getElementById(t),getFirstChild:e=>(null==e?void 0:e.firstChild)||null,getLastChild:e=>(null==e?void 0:e.lastChild)||null,getNextSibling:e=>(null==e?void 0:e.nextSibling)||null,getPreviousSibling:e=>(null==e?void 0:e.previousSibling)||null,getFirstElementChild:e=>(null==e?void 0:e.firstElementChild)||null,getLastElementChild:e=>(null==e?void 0:e.lastElementChild)||null,getNextElementSibling:e=>(null==e?void 0:e.nextElementSibling)||null,getPreviousElementSibling:e=>(null==e?void 0:e.previousElementSibling)||null,appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,i)=>e.insertBefore(t,i),getSelection:e=>{var t;return(null==(t=e.ownerDocument)?void 0:t.getSelection())||null},getElementsByName:(e,t)=>e.ownerDocument.getElementsByName(t)},R="undefined"!=typeof DOMRect?DOMRect:class{constructor(e,t,i,s){this.left=e||0,this.top=t||0,this.right=(e||0)+(i||0),this.bottom=(t||0)+(s||0)}},P=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),s=!1}catch(e){s=!0}function M(e){let t=e(),i=t.__tabsterInstanceContext;return i||(i={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=i),i}class N{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||!(!t&&G(e._target.ownerDocument,e._target))&&(delete e._target,!0)}}class A{constructor(e,t,i){let s,r=M(e);r.WeakRef?s=new r.WeakRef(t):(s=new N(t),r.fakeWeakRefs.push(s)),this._ref=s,this._data=i}get(){let e,t=this._ref;return t&&((e=t.deref())||delete this._ref),e}getData(){return this._data}}function x(e,t){let i=M(e);i.fakeWeakRefs=i.fakeWeakRefs.filter(e=>!N.cleanup(e,t))}function L(e,t,i){if(t.nodeType!==Node.ELEMENT_NODE)return;let r=s?i:{acceptNode:i};return D.createTreeWalker(e,t,NodeFilter.SHOW_ELEMENT,r,!1)}function W(e,t){let i=t.__tabsterCacheId,s=M(e),r=i?s.containerBoundingRectCache[i]:void 0;if(r)return r.rect;let n=t.ownerDocument&&t.ownerDocument.documentElement;if(!n)return new R;let o=0,l=0,a=n.clientWidth,u=n.clientHeight;if(t!==n){let e=t.getBoundingClientRect();o=Math.max(o,e.left),l=Math.max(l,e.top),a=Math.min(a,e.right),u=Math.min(u,e.bottom)}let d=new R(o<a?o:-1,l<u?l:-1,o<a?a-o:0,l<u?u-l:0);return i||(t.__tabsterCacheId=i="r-"+ ++s.lastContainerBoundingRectCacheId),s.containerBoundingRectCache[i]={rect:d,element:t},s.containerBoundingRectCacheTimer||(s.containerBoundingRectCacheTimer=window.setTimeout(()=>{for(let e of(s.containerBoundingRectCacheTimer=void 0,Object.keys(s.containerBoundingRectCache)))delete s.containerBoundingRectCache[e].element.__tabsterCacheId;s.containerBoundingRectCache={}},50)),d}function S(e,t,i){let s=B(t);if(!s)return!1;let r=W(e,s),n=t.getBoundingClientRect(),o=n.height*(1-i),l=Math.max(0,r.top-n.top)+Math.max(0,n.bottom-r.bottom);return 0===l||l<=o}function B(e){let t=e.ownerDocument;if(t){for(let t=D.getParentElement(e);t;t=D.getParentElement(t))if(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)return t;return t.documentElement}return null}function z(e){return!!e.__shouldIgnoreFocus}function U(e,t){let i=M(e),s=t.__tabsterElementUID;return s||(s=t.__tabsterElementUID=function(e){let t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=0xffffffff*Math.random();let i=[];for(let e=0;e<t.length;e++)i.push(t[e].toString(36));return i.push("|"),i.push((++P).toString(36)),i.push("|"),i.push(Date.now().toString(36)),i.join("")}(e())),!i.elementByUId[s]&&G(t.ownerDocument,t)&&(i.elementByUId[s]=new A(e,t)),s}function V(e,t){let i=M(e);for(let e of Object.keys(i.elementByUId)){let s=i.elementByUId[e],r=s&&s.get();(!r||!t||D.nodeContains(t,r))&&delete i.elementByUId[e]}}function G(e,t){return D.nodeContains(null==e?void 0:e.body,t)}function K(e,t){let i=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return i&&i.call(e,t)}let H=0;class j{constructor(e,t,i){let s=e.getWindow;this._tabster=e,this._element=new A(s,t),this._props={...i},this.id="i"+ ++H}getElement(){return this._element.get()}getProps(){return this._props}setProps(e){this._props={...e}}}class Q{constructor(e,t,i,s,n){var o;this._focusIn=e=>{if(this._fixedTarget){let e=this._fixedTarget.get();e&&(0,r.kG)(e);return}let t=this.input;if(this.onFocusIn&&t){let i=e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,i),i)}},this._focusOut=e=>{if(this._fixedTarget)return;this.useDefaultAction=!1;let t=this.input;if(this.onFocusOut&&t){let i=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,i),i)}};let l=e(),a=l.document.createElement("i");a.tabIndex=0,a.setAttribute("role","none"),a.setAttribute("data-tabster-dummy",""),a.setAttribute("aria-hidden","true");let u=a.style;u.position="fixed",u.width=u.height="1px",u.opacity="0.001",u.zIndex="-1",u.setProperty("content-visibility","hidden"),a.__shouldIgnoreFocus=!0,this.input=a,this.isFirst=i.isFirst,this.isOutside=t,this._isPhantom=null!=(o=i.isPhantom)&&o,this._fixedTarget=n,a.addEventListener("focusin",this._focusIn),a.addEventListener("focusout",this._focusOut),a.__tabsterDummyContainer=s,this._isPhantom&&(this._disposeTimer=l.setTimeout(()=>{delete this._disposeTimer,this.dispose()},0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(l.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var e;this._clearDisposeTimeout&&this._clearDisposeTimeout();let t=this.input;t&&(delete this._fixedTarget,delete this.onFocusIn,delete this.onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),delete t.__tabsterDummyContainer,null==(e=D.getParentNode(t))||e.removeChild(t))}setTopLeft(e,t){var i;let s=null==(i=this.input)?void 0:i.style;s&&(s.top=`${e}px`,s.left=`${t}px`)}_isBackward(e,t,i){return e&&!i?!this.isFirst:!!(i&&t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_FOLLOWING)}}let J={Root:1,Mover:3,Groupper:4};class q{constructor(e,t,i,s,r,n){this._element=t,this._instance=new $(e,t,this,i,s,r,n)}_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}moveOut(e){var t;null==(t=this._instance)||t.moveOut(e)}moveOutWithDefaultAction(e,t){var i;null==(i=this._instance)||i.moveOutWithDefaultAction(e,t)}getHandler(e){return e?this._onFocusIn:this._onFocusOut}setTabbable(e){var t;null==(t=this._instance)||t.setTabbable(this,e)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static moveWithPhantomDummy(e,t,i,s,n){let o=new Q(e.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(o){let l,a;if("BODY"===t.tagName)l=t,a=i&&s||!i&&!s?D.getFirstElementChild(t):null;else{let r,n;i&&(!s||s&&!e.focusable.isFocusable(t,!1,!0,!0))?(l=t,a=s?t.firstElementChild:null):(l=D.getParentElement(t),a=i&&s||!i&&!s?t:D.getNextElementSibling(t));do(n=ee(r=i&&s||!i&&!s?D.getPreviousElementSibling(a):a))===t?a=i&&s||!i&&!s?r:D.getNextElementSibling(r):n=null;while(n)}(null==l?void 0:l.dispatchEvent(new T({by:"root",owner:l,next:null,relatedEvent:n})))&&(D.insertBefore(l,o,a),(0,r.kG)(o))}}static addPhantomDummyWithTarget(e,t,i,s){let r=new Q(e.getWindow,!0,{isPhantom:!0,isFirst:!0},void 0,new A(e.getWindow,s)).input;if(r){let e,s;!t.querySelector(o)||i?(e=D.getParentElement(t),s=i?t:D.getNextElementSibling(t)):(e=t,s=D.getFirstElementChild(t)),e&&D.insertBefore(e,r,s)}}}class Y{constructor(e){this._updateQueue=new Set,this._lastUpdateQueueTime=0,this._changedParents=new WeakSet,this._dummyElements=[],this._dummyCallbacks=new WeakMap,this._domChanged=e=>{var t;!this._changedParents.has(e)&&(this._changedParents.add(e),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null==(t=this._win)?void 0:t.call(this).setTimeout(()=>{for(let e of(delete this._updateDummyInputsTimer,this._dummyElements)){let t=e.get();if(t){let e=this._dummyCallbacks.get(t);if(e){let i=D.getParentNode(t);(!i||this._changedParents.has(i))&&e()}}}this._changedParents=new WeakSet},100)))},this._win=e}add(e,t){!this._dummyCallbacks.has(e)&&this._win&&(this._dummyElements.push(new A(this._win,e)),this._dummyCallbacks.set(e,t),this.domChanged=this._domChanged)}remove(e){this._dummyElements=this._dummyElements.filter(t=>{let i=t.get();return i&&i!==e}),this._dummyCallbacks.delete(e),0===this._dummyElements.length&&delete this.domChanged}dispose(){var e;let t=null==(e=this._win)?void 0:e.call(this);this._updateTimer&&(null==t||t.clearTimeout(this._updateTimer),delete this._updateTimer),this._updateDummyInputsTimer&&(null==t||t.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummyCallbacks=new WeakMap,this._dummyElements=[],this._updateQueue.clear(),delete this.domChanged,delete this._win}updatePositions(e){this._win&&(this._updateQueue.add(e),this._lastUpdateQueueTime=Date.now(),this._scheduledUpdatePositions())}_scheduledUpdatePositions(){var e;this._updateTimer||(this._updateTimer=null==(e=this._win)?void 0:e.call(this).setTimeout(()=>{if(delete this._updateTimer,this._lastUpdateQueueTime+100<=Date.now()){let e=new Map,t=[];for(let i of this._updateQueue)t.push(i(e));for(let e of(this._updateQueue.clear(),t))e();e.clear()}else this._scheduledUpdatePositions()},100))}}class ${constructor(e,t,i,s,n,o,l){this._wrappers=[],this._isOutside=!1,this._transformElements=new Set,this._onFocusIn=(e,t,i)=>{this._onFocus(!0,e,t,i)},this._onFocusOut=(e,t,i)=>{this._onFocus(!1,e,t,i)},this.moveOut=e=>{var t;let i=this._firstDummy,s=this._lastDummy;if(i&&s){this._ensurePosition();let n=i.input,o=s.input,l=null==(t=this._element)?void 0:t.get();if(n&&o&&l){let t;e?(n.tabIndex=0,t=n):(o.tabIndex=0,t=o),t&&(0,r.kG)(t)}}},this.moveOutWithDefaultAction=(e,t)=>{var i;let s=this._firstDummy,n=this._lastDummy;if(s&&n){this._ensurePosition();let o=s.input,l=n.input,a=null==(i=this._element)?void 0:i.get();if(o&&l&&a){let i;e?!s.isOutside&&this._tabster.focusable.isFocusable(a,!0,!0,!0)?i=a:(s.useDefaultAction=!0,o.tabIndex=0,i=o):(n.useDefaultAction=!0,l.tabIndex=0,i=l),i&&a.dispatchEvent(new T({by:"root",owner:a,next:null,relatedEvent:t}))&&(0,r.kG)(i)}}},this.setTabbable=(e,t)=>{var i,s;for(let i of this._wrappers)if(i.manager===e){i.tabbable=t;break}let r=this._getCurrent();if(r){let e=r.tabbable?0:-1,t=null==(i=this._firstDummy)?void 0:i.input;t&&(t.tabIndex=e),(t=null==(s=this._lastDummy)?void 0:s.input)&&(t.tabIndex=e)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout(()=>{delete this._addTimer,this._ensurePosition(),this._addTransformOffsets()},0))},this._addTransformOffsets=()=>{this._tabster._dummyObserver.updatePositions(this._computeTransformOffsets)},this._computeTransformOffsets=e=>{var t,i;let s=(null==(t=this._firstDummy)?void 0:t.input)||(null==(i=this._lastDummy)?void 0:i.input),r=this._transformElements,n=new Set,o=0,l=0,a=this._getWindow();for(let t=s;t&&t.nodeType===Node.ELEMENT_NODE;t=D.getParentElement(t)){let i=e.get(t);if(void 0===i){let s=a.getComputedStyle(t).transform;s&&"none"!==s&&(i={scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),e.set(t,i||null)}i&&(n.add(t),r.has(t)||t.addEventListener("scroll",this._addTransformOffsets),o+=i.scrollTop,l+=i.scrollLeft)}for(let e of r)n.has(e)||e.removeEventListener("scroll",this._addTransformOffsets);return this._transformElements=n,()=>{var e,t;null==(e=this._firstDummy)||e.setTopLeft(o,l),null==(t=this._lastDummy)||t.setTopLeft(o,l)}};let a=t.get();if(!a)throw Error("No element");this._tabster=e,this._getWindow=e.getWindow,this._callForDefaultAction=l;let u=a.__tabsterDummy;if((u||this)._wrappers.push({manager:i,priority:s,tabbable:!0}),u)return u;a.__tabsterDummy=this;let d=null==n?void 0:n.dummyInputsPosition,h=a.tagName;this._isOutside=d?d===m.Outside:(o||"UL"===h||"OL"===h||"TABLE"===h)&&"LI"!==h&&"TD"!==h&&"TH"!==h,this._firstDummy=new Q(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new Q(this._getWindow,this._isOutside,{isFirst:!1},t);let c=this._firstDummy.input;c&&e._dummyObserver.add(c,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs()}dispose(e,t){var i,s,r,n;if(0===(this._wrappers=this._wrappers.filter(i=>i.manager!==e&&!t)).length){for(let e of(delete(null==(i=this._element)?void 0:i.get()).__tabsterDummy,this._transformElements))e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements.clear();let e=this._getWindow();this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer);let t=null==(s=this._firstDummy)?void 0:s.input;t&&this._tabster._dummyObserver.remove(t),null==(r=this._firstDummy)||r.dispose(),null==(n=this._lastDummy)||n.dispose()}}_onFocus(e,t,i,s){var r;let n=this._getCurrent();n&&(!t.useDefaultAction||this._callForDefaultAction)&&(null==(r=n.manager.getHandler(e))||r(t,i,s))}_getCurrent(){return this._wrappers.sort((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority),this._wrappers[0]}_ensurePosition(){var e,t,i;let s=null==(e=this._element)?void 0:e.get(),r=null==(t=this._firstDummy)?void 0:t.input,n=null==(i=this._lastDummy)?void 0:i.input;if(s&&r&&n)if(this._isOutside){let e=D.getParentNode(s);if(e){let t=D.getNextSibling(s);t!==n&&D.insertBefore(e,n,t),D.getPreviousElementSibling(s)!==r&&D.insertBefore(e,r,s)}}else{D.getLastElementChild(s)!==n&&D.appendChild(s,n);let e=D.getFirstElementChild(s);e&&e!==r&&e.parentNode&&D.insertBefore(e.parentNode,r,e)}}}function X(e){let t=null;for(let i=D.getLastElementChild(e);i;i=D.getLastElementChild(i))t=i;return t||void 0}function Z(e){return"INPUT"===e.tagName&&!!e.name&&"radio"===e.type}function ee(e){var t;return(null==(t=null==e?void 0:e.__tabsterDummyContainer)?void 0:t.get())||null}function et(e,t){let i=JSON.stringify(e);return!0===t?i:{[n]:i}}class ei extends q{constructor(e,t,i,s){super(e,t,J.Root,s,void 0,!0),this._onDummyInputFocus=e=>{var t;if(e.useDefaultAction)this._setFocused(!1);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);let i=this._element.get();if(i){this._setFocused(!0);let t=this._tabster.focusedElement.getFirstOrLastTabbable(e.isFirst,{container:i,ignoreAccessibility:!0});if(t)return void(0,r.kG)(t)}null==(t=e.input)||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=i}}class es extends j{constructor(e,t,i,s,n){super(e,t,s),this._isFocused=!1,this._setFocused=e=>{var t;if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;let i=this._element.get();i&&(e?(this._isFocused=!0,null==(t=this._dummyManager)||t.setTabbable(!1),i.dispatchEvent(new I({element:i}))):this._setFocusedTimer=this._tabster.getWindow().setTimeout(()=>{var e;delete this._setFocusedTimer,this._isFocused=!1,null==(e=this._dummyManager)||e.setTabbable(!0),i.dispatchEvent(new O({element:i}))},0))},this._onFocusIn=e=>{let t=this._tabster.getParent,i=this._element.get(),s=e.composedPath()[0];do{if(s===i)return void this._setFocused(!0);s=s&&t(s)}while(s)},this._onFocusOut=()=>{this._setFocused(!1)},this._onDispose=i;let o=e.getWindow;this.uid=U(o,t),this._sys=n,(e.controlTab||e.rootDummyInputs)&&this.addDummyInputs();let l=o().document;l.addEventListener(r.Oy,this._onFocusIn),l.addEventListener(r.RY,this._onFocusOut),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new ei(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var e;this._onDispose(this);let t=this._tabster.getWindow(),i=t.document;i.removeEventListener(r.Oy,this._onFocusIn),i.removeEventListener(r.RY,this._onFocusOut),this._setFocusedTimer&&(t.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null==(e=this._dummyManager)||e.dispose(),this._remove()}moveOutWithDefaultAction(e,t){let i=this._dummyManager;if(i)i.moveOutWithDefaultAction(e,t);else{let i=this.getElement();i&&ei.moveWithPhantomDummy(this._tabster,i,!0,e,t)}}_add(){}_remove(){}}class er{constructor(e,t){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._autoRootCreate=()=>{var e;let t=this._win().document,i=t.body;if(i){this._autoRootUnwait(t);let s=this._autoRoot;if(s)return!function(e,t,i){let s;if(i){let t=e.getAttribute(n);if(t)try{s=JSON.parse(t)}catch(e){}}s||(s={});var r=s;for(let e of Object.keys(t)){let i=t[e];i?r[e]=i:delete r[e]}Object.keys(s).length>0?e.setAttribute(n,et(s,!0)):e.removeAttribute(n)}(i,{root:s},!0),f(this._tabster,i),null==(e=_(this._tabster,i))?void 0:e.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,t.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._autoRoot=t,e.queueInit(()=>{this._autoRoot&&this._autoRootCreate()})}_autoRootUnwait(e){e.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){let e=this._win();this._autoRootUnwait(e.document),delete this._autoRoot,Object.keys(this._roots).forEach(e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])}),this.rootById={}}createRoot(e,t,i){let s=new es(this._tabster,e,this._onRootDispose,t,i);return this._roots[s.id]=s,this._forceDummy&&s.addDummyInputs(),s}addDummyInputs(){this._forceDummy=!0;let e=this._roots;for(let t of Object.keys(e))e[t].addDummyInputs()}static getRootByUId(e,t){let i=e().__tabsterInstance;return i&&i.root.rootById[t]}static getTabsterContext(e,t,i){var s,r,n,o;let l,a,u,d,h,c,m,f;if(void 0===i&&(i={}),!t.ownerDocument)return;let{checkRtl:b,referenceElement:p}=i,v=e.getParent;e.drainInitQueue();let g=!1,E=p||t,w={};for(;E&&(!l||b);){let i=_(e,E);if(b&&void 0===m){let e=E.dir;e&&(m="rtl"===e.toLowerCase())}if(!i){E=v(E);continue}let o=E.tagName;(i.uncontrolled||"IFRAME"===o||"WEBVIEW"===o)&&e.focusable.isVisible(E)&&(f=E),!d&&(null==(s=i.focusable)?void 0:s.excludeFromMover)&&!u&&(g=!0);let p=i.modalizer,y=i.groupper,T=i.mover;!a&&p&&(a=p),!u&&y&&(!a||p)&&(a?(!y.isActive()&&y.getProps().tabbability&&a.userId!==(null==(r=e.modalizer)?void 0:r.activeId)&&(a=void 0,u=y),c=y):u=y),!d&&T&&(!a||p)&&(!y||E!==t)&&E.contains(t)&&(d=T,h=!!u&&u!==y),i.root&&(l=i.root),(null==(n=i.focusable)?void 0:n.ignoreKeydown)&&Object.assign(w,i.focusable.ignoreKeydown),E=v(E)}if(!l){let i=e.root;i._autoRoot&&(null==(o=t.ownerDocument)?void 0:o.body)&&(l=i._autoRootCreate())}return u&&!d&&(h=!0),l?{root:l,modalizer:a,groupper:u,mover:d,groupperBeforeMover:h,modalizerInGroupper:c,rtl:b?!!m:void 0,uncontrolled:f,excludedFromMover:g,ignoreKeydown:e=>!!w[e.key]}:void 0}static getRoot(e,t){var i;let s=e.getParent;for(let r=t;r;r=s(r)){let t=null==(i=_(e,r))?void 0:i.root;if(t)return t}}onRoot(e,t){t?delete this.rootById[e.uid]:this.rootById[e.uid]=e}}class en{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(e){let t=this._callbacks;0>t.indexOf(e)&&t.push(e)}subscribeFirst(e){let t=this._callbacks,i=t.indexOf(e);i>=0&&t.splice(i,1),t.unshift(e)}unsubscribe(e){let t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)}setVal(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))}getVal(){return this._val}trigger(e,t){this._callCallbacks(e,t)}_callCallbacks(e,t){this._callbacks.forEach(i=>i(e,t))}}class eo{constructor(e){this._tabster=e}dispose(){}getProps(e){let t=_(this._tabster,e);return t&&t.focusable||{}}isFocusable(e,t,i,s){return!!K(e,o)&&(!!t||-1!==e.tabIndex)&&(i||this.isVisible(e))&&(s||this.isAccessible(e))}isVisible(e){if(!e.ownerDocument||e.nodeType!==Node.ELEMENT_NODE||function(e){var t,i;let s=e.ownerDocument,r=null==(t=s.defaultView)?void 0:t.getComputedStyle(e);return null===e.offsetParent&&s.body!==e&&(null==r?void 0:r.position)!=="fixed"||(null==r?void 0:r.visibility)==="hidden"||(null==r?void 0:r.position)==="fixed"&&("none"===r.display||(null==(i=e.parentElement)?void 0:i.offsetParent)===null&&s.body!==e.parentElement)||!1}(e))return!1;let t=e.ownerDocument.body.getBoundingClientRect();return 0!==t.width||0!==t.height}isAccessible(e){var t;for(let i=e;i;i=D.getParentElement(i)){let e=_(this._tabster,i);if(this._isHidden(i)||!(null==(t=null==e?void 0:e.focusable)?void 0:t.ignoreAriaDisabled)&&this._isDisabled(i))return!1}return!0}_isDisabled(e){return e.hasAttribute("disabled")}_isHidden(e){var t;let i=e.getAttribute("aria-hidden");return!(!i||"true"!==i.toLowerCase()||(null==(t=this._tabster.modalizer)?void 0:t.isAugmented(e)))}findFirst(e,t){return this.findElement({...e},t)}findLast(e,t){return this.findElement({isBackward:!0,...e},t)}findNext(e,t){return this.findElement({...e},t)}findPrev(e,t){return this.findElement({...e,isBackward:!0},t)}findDefault(e,t){return this.findElement({...e,acceptCondition:t=>this.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault},t)||null}findAll(e){return this._findElements(!0,e)||[]}findElement(e,t){let i=this._findElements(!1,e,t);return i?i[0]:i}_findElements(e,t,i){var s,r,n;let{container:o,currentElement:l=null,includeProgrammaticallyFocusable:a,useActiveModalizer:u,ignoreAccessibility:d,modalizerId:h,isBackward:c,onElement:m}=t;i||(i={});let _=[],{acceptCondition:f}=t,b=!!f;if(!o)return null;f||(f=e=>this.isFocusable(e,a,!1,d));let p={container:o,modalizerUserId:void 0===h&&u?null==(s=this._tabster.modalizer)?void 0:s.activeId:h||(null==(n=null==(r=er.getTabsterContext(this._tabster,o))?void 0:r.modalizer)?void 0:n.userId),from:l||o,isBackward:c,isFindAll:e,acceptCondition:f,hasCustomCondition:b,includeProgrammaticallyFocusable:a,ignoreAccessibility:d,cachedGrouppers:{},cachedRadioGroups:{}},v=L(o.ownerDocument,o,e=>this._acceptElement(e,p));if(!v)return null;let g=t=>{var s,r;let n=null!=(s=p.foundElement)?s:p.foundBackward;return(n&&_.push(n),e)?(!n||(p.found=!1,delete p.foundElement,delete p.foundBackward,delete p.fromCtx,p.from=n,!m||!!m(n)))&&!!(n||t):(n&&i&&(i.uncontrolled=null==(r=er.getTabsterContext(this._tabster,n))?void 0:r.uncontrolled),!!(t&&!n))};if(l||(i.outOfDOMOrder=!0),l&&D.nodeContains(o,l))v.currentNode=l;else if(c){let e=X(o);if(!e)return null;if(this._acceptElement(e,p)===NodeFilter.FILTER_ACCEPT&&!g(!0))return p.skippedFocusable&&(i.outOfDOMOrder=!0),_;v.currentNode=e}do c?v.previousNode():v.nextNode();while(g());return p.skippedFocusable&&(i.outOfDOMOrder=!0),_.length?_:null}_acceptElement(e,t){var i,s,r;let n;if(t.found)return NodeFilter.FILTER_ACCEPT;let o=t.foundBackward;if(o&&(e===o||!D.nodeContains(o,e)))return t.found=!0,t.foundElement=o,NodeFilter.FILTER_ACCEPT;let l=t.container;if(e===l)return NodeFilter.FILTER_SKIP;if(!D.nodeContains(l,e)||ee(e)||D.nodeContains(t.rejectElementsFrom,e))return NodeFilter.FILTER_REJECT;let a=t.currentCtx=er.getTabsterContext(this._tabster,e);if(!a)return NodeFilter.FILTER_SKIP;if(z(e))return this.isFocusable(e,void 0,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_SKIP;if(!t.hasCustomCondition&&("IFRAME"===e.tagName||"WEBVIEW"===e.tagName))if(this.isVisible(e)&&(null==(i=a.modalizer)?void 0:i.userId)===(null==(s=this._tabster.modalizer)?void 0:s.activeId))return t.found=!0,t.rejectElementsFrom=t.foundElement=e,NodeFilter.FILTER_ACCEPT;else return NodeFilter.FILTER_REJECT;if(!t.ignoreAccessibility&&!this.isAccessible(e))return this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_REJECT;let u=t.fromCtx;u||(u=t.fromCtx=er.getTabsterContext(this._tabster,t.from));let d=null==u?void 0:u.mover,h=a.groupper,c=a.mover;if(void 0!==(n=null==(r=this._tabster.modalizer)?void 0:r.acceptElement(e,t))&&(t.skippedFocusable=!0),void 0===n&&(h||c||d)){let i=null==h?void 0:h.getElement(),s=null==d?void 0:d.getElement(),r=null==c?void 0:c.getElement();if(r&&D.nodeContains(s,r)&&D.nodeContains(l,s)&&(!i||!c||D.nodeContains(s,i))&&(c=d,r=s),i)if(i!==l&&D.nodeContains(l,i)){if(!D.nodeContains(i,e))return NodeFilter.FILTER_REJECT}else h=void 0;if(r)if(D.nodeContains(l,r)){if(!D.nodeContains(r,e))return NodeFilter.FILTER_REJECT}else c=void 0;h&&c&&(r&&i&&!D.nodeContains(i,r)?c=void 0:h=void 0),h&&(n=h.acceptElement(e,t)),c&&(n=c.acceptElement(e,t))}if(void 0===n&&(n=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP)===NodeFilter.FILTER_SKIP&&this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0),n===NodeFilter.FILTER_ACCEPT&&!t.found){if(!t.isFindAll&&Z(e)&&!e.checked){let i=e.name,s=t.cachedRadioGroups[i];if(!s&&(s=function(e){let t;if(!Z(e))return;let i=e.name,s=Array.from(D.getElementsByName(e,i));return{name:i,buttons:new Set(s=s.filter(e=>!!Z(e)&&(e.checked&&(t=e),!0))),checked:t}}(e))&&(t.cachedRadioGroups[i]=s),(null==s?void 0:s.checked)&&s.checked!==e)return NodeFilter.FILTER_SKIP}t.isBackward?(t.foundBackward=e,n=NodeFilter.FILTER_SKIP):(t.found=!0,t.foundElement=e)}return n}}let el={Tab:"Tab",Enter:"Enter",Escape:"Escape",PageUp:"PageUp",PageDown:"PageDown",End:"End",Home:"Home",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown"},ea={[l.Restorer]:0,[l.Deloser]:1,[l.EscapeGroupper]:2};class eu extends en{constructor(e,t){super(),this._init=()=>{let e=this._win(),t=e.document;t.addEventListener(r.Oy,this._onFocusIn,!0),t.addEventListener(r.RY,this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0);let i=D.getActiveElement(t);i&&i!==t.body&&this._setFocusedElement(i),this.subscribe(this._onChanged)},this._onFocusIn=e=>{let t=e.composedPath()[0];t&&this._setFocusedElement(t,e.detail.relatedTarget,e.detail.isFocusedProgrammatically)},this._onFocusOut=e=>{var t;this._setFocusedElement(void 0,null==(t=e.detail)?void 0:t.originalEvent.relatedTarget)},this._validateFocusedElement=e=>{},this._onKeyDown=e=>{if(e.key!==el.Tab||e.ctrlKey)return;let t=this.getVal();if(!t||!t.ownerDocument||"true"===t.contentEditable)return;let i=this._tabster,s=i.controlTab,n=er.getTabsterContext(i,t);if(!n||n.ignoreKeydown(e))return;let o=e.shiftKey,l=eu.findNextTabbable(i,n,void 0,t,void 0,o,!0),a=n.root.getElement();if(!a)return;let u=null==l?void 0:l.element,d=function(e,t){var i;let s=e.getParent,r=t;do{let t=null==(i=_(e,r))?void 0:i.uncontrolled;if(t&&e.uncontrolled.isUncontrolledCompletely(r,!!t.completely))return r;r=s(r)}while(r)}(i,t);if(u){let h=l.uncontrolled;if(n.uncontrolled||D.nodeContains(h,t)){if(!l.outOfDOMOrder&&h===n.uncontrolled||d&&!D.nodeContains(d,u))return;q.addPhantomDummyWithTarget(i,t,o,u);return}if(h&&i.focusable.isVisible(h)||"IFRAME"===u.tagName&&i.focusable.isVisible(u)){a.dispatchEvent(new T({by:"root",owner:a,next:u,relatedEvent:e}))&&q.moveWithPhantomDummy(i,null!=h?h:u,!1,o,e);return}(s||(null==l?void 0:l.outOfDOMOrder))&&a.dispatchEvent(new T({by:"root",owner:a,next:u,relatedEvent:e}))&&(e.preventDefault(),e.stopImmediatePropagation(),(0,r.kG)(u))}else!d&&a.dispatchEvent(new T({by:"root",owner:a,next:null,relatedEvent:e}))&&n.root.moveOutWithDefaultAction(o,e)},this._onChanged=(e,t)=>{var i,s;if(e)e.dispatchEvent(new w(t));else{let e=null==(i=this._lastVal)?void 0:i.get();if(e){let i={...t},r=er.getTabsterContext(this._tabster,e),n=null==(s=null==r?void 0:r.modalizer)?void 0:s.userId;n&&(i.modalizerId=n),e.dispatchEvent(new y(i))}}},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){super.dispose();let e=this._win(),t=e.document;t.removeEventListener(r.Oy,this._onFocusIn,!0),t.removeEventListener(r.RY,this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged);let i=this._asyncFocus;i&&(e.clearTimeout(i.timeout),delete this._asyncFocus),delete eu._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var i,s;let r=eu._lastResetElement,n=r&&r.get();n&&D.nodeContains(t,n)&&delete eu._lastResetElement,(n=null==(s=null==(i=e._nextVal)?void 0:i.element)?void 0:s.get())&&D.nodeContains(t,n)&&delete e._nextVal,(n=(r=e._lastVal)&&r.get())&&D.nodeContains(t,n)&&delete e._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var e;let t=null==(e=this._lastVal)?void 0:e.get();return t&&(!t||G(t.ownerDocument,t))||(this._lastVal=t=void 0),t}focus(e,t,i,s){return!!this._tabster.focusable.isFocusable(e,t,!1,i)&&(e.focus({preventScroll:s}),!0)}focusDefault(e){let t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)}getFirstOrLastTabbable(e,t){var i;let s,{container:r,ignoreAccessibility:n}=t;if(r){let t=er.getTabsterContext(this._tabster,r);t&&(s=null==(i=eu.findNextTabbable(this._tabster,t,r,void 0,void 0,!e,n))?void 0:i.element)}return s&&!D.nodeContains(r,s)&&(s=void 0),s||void 0}_focusFirstOrLast(e,t){let i=this.getFirstOrLastTabbable(e,t);return!!i&&(this.focus(i,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}focusLast(e){return this._focusFirstOrLast(!1,e)}resetFocus(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{let t=e.getAttribute("tabindex"),i=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),eu._lastResetElement=new A(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",t),this._setOrRemoveAttribute(e,"aria-hidden",i)}return!0}requestAsyncFocus(e,t,i){let s=this._tabster.getWindow(),r=this._asyncFocus;if(r){if(ea[e]>ea[r.source])return;s.clearTimeout(r.timeout)}this._asyncFocus={source:e,callback:t,timeout:s.setTimeout(()=>{this._asyncFocus=void 0,t()},i)}}cancelAsyncFocus(e){let t=this._asyncFocus;(null==t?void 0:t.source)===e&&(this._tabster.getWindow().clearTimeout(t.timeout),this._asyncFocus=void 0)}_setOrRemoveAttribute(e,t,i){null===i?e.removeAttribute(t):e.setAttribute(t,i)}_setFocusedElement(e,t,i){var s,r;if(this._tabster._noop)return;let n={relatedTarget:t};if(e){let t=null==(s=eu._lastResetElement)?void 0:s.get();if(eu._lastResetElement=void 0,t===e||z(e))return;n.isFocusedProgrammatically=i;let o=er.getTabsterContext(this._tabster,e),l=null==(r=null==o?void 0:o.modalizer)?void 0:r.userId;l&&(n.modalizerId=l)}let o=this._nextVal={element:e?new A(this._win,e):void 0,detail:n};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===o&&this.setVal(e,n),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new A(this._win,e))}static findNextTabbable(e,t,i,s,r,n,o){let l=i||t.root.getElement();if(!l)return null;let a=null,u=eu._isTabbingTimer,d=e.getWindow();u&&d.clearTimeout(u),eu.isTabbing=!0,eu._isTabbingTimer=d.setTimeout(()=>{delete eu._isTabbingTimer,eu.isTabbing=!1},0);let h=t.modalizer,c=t.groupper,m=t.mover,_=t=>{if(a=t.findNextTabbable(s,r,n,o),s&&!(null==a?void 0:a.element)){let r=t!==h&&D.getParentElement(t.getElement());if(r){let l=er.getTabsterContext(e,s,{referenceElement:r});if(l){let s=t.getElement(),u=n?s:s&&X(s)||s;u&&(a=eu.findNextTabbable(e,l,i,u,r,n,o))&&(a.outOfDOMOrder=!0)}}}};if(c&&m)_(t.groupperBeforeMover?c:m);else if(c)_(c);else if(m)_(m);else if(h)_(h);else{let t={};a={element:e.focusable[n?"findPrev":"findNext"]({container:l,currentElement:s,referenceElement:r,ignoreAccessibility:o,useActiveModalizer:!0},t),outOfDOMOrder:t.outOfDOMOrder,uncontrolled:t.uncontrolled}}return a}}eu.isTabbing=!1;class ed extends q{constructor(e,t,i,s){super(i,e,J.Groupper,s,!0),this._setHandlers((s,n,o)=>{var l,a;let u=e.get(),d=s.input;if(u&&d){let e=er.getTabsterContext(i,d);if(e){let h;(h=null==(l=t.findNextTabbable(o||void 0,void 0,n,!0))?void 0:l.element)||(h=null==(a=eu.findNextTabbable(i,e,void 0,s.isOutside?d:function(e,t){let i=e,s=null;for(;i&&!s;)s=t?D.getPreviousElementSibling(i):D.getNextElementSibling(i),i=D.getParentElement(i);return s||void 0}(u,!n),void 0,n,!0))?void 0:a.element),h&&(0,r.kG)(h)}}})}}class eh extends j{constructor(e,t,i,s,r){super(e,t,s),this._shouldTabInside=!1,this.makeTabbable(!1),this._onDispose=i,e.controlTab||(this.dummyManager=new ed(this._element,this,e,r))}dispose(){var e;this._onDispose(this),this._element.get(),null==(e=this.dummyManager)||e.dispose(),delete this.dummyManager,delete this._first}findNextTabbable(e,t,i,s){let r,n=this.getElement();if(!n)return null;let o=ee(e)===n;if(!this._shouldTabInside&&e&&D.nodeContains(n,e)&&!o)return{element:void 0,outOfDOMOrder:!0};let l=this.getFirst(!0);if(!e||!D.nodeContains(n,e)||o)return{element:l,outOfDOMOrder:!0};let a=this._tabster,u=null,d=!1;if(this._shouldTabInside&&l){let o={};u=a.focusable[i?"findPrev":"findNext"]({container:n,currentElement:e,referenceElement:t,ignoreAccessibility:s,useActiveModalizer:!0},o),d=!!o.outOfDOMOrder,u||this._props.tabbability!==h.LimitedTrapFocus||(u=a.focusable[i?"findLast":"findFirst"]({container:n,ignoreAccessibility:s,useActiveModalizer:!0},o),d=!0),r=o.uncontrolled}return{element:u,uncontrolled:r,outOfDOMOrder:d}}makeTabbable(e){this._shouldTabInside=e||!this._props.tabbability}isActive(e){var t;let i=this.getElement()||null,s=!0;for(let e=D.getParentElement(i);e;e=D.getParentElement(e)){let i=null==(t=_(this._tabster,e))?void 0:t.groupper;i&&!i._shouldTabInside&&(s=!1)}let r=s?!!this._props.tabbability&&this._shouldTabInside:void 0;if(r&&e){let e=this._tabster.focusedElement.getFocusedElement();e&&(r=e!==this.getFirst(!0))}return r}getFirst(e){var t;let i,s=this.getElement();if(s){if(e&&this._tabster.focusable.isFocusable(s))return s;!(i=null==(t=this._first)?void 0:t.get())&&(i=this._tabster.focusable.findFirst({container:s,useActiveModalizer:!0})||void 0)&&this.setFirst(i)}return i}setFirst(e){e?this._first=new A(this._tabster.getWindow,e):delete this._first}acceptElement(e,t){let i,s=t.cachedGrouppers,r=D.getParentElement(this.getElement()),n=r&&er.getTabsterContext(this._tabster,r),o=null==n?void 0:n.groupper,l=(null==n?void 0:n.groupperBeforeMover)?o:void 0,a=e=>{let t,i=s[e.id];return i?t=i.isActive:(t=this.isActive(!0),i=s[e.id]={isActive:t}),t};if(l&&(i=l.getElement(),!a(l)&&i&&t.container!==i&&D.nodeContains(t.container,i)))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;let u=a(this),d=this.getElement();if(d&&!0!==u){let r;if(d===e&&o&&(i||(i=o.getElement()),i&&!a(o)&&D.nodeContains(t.container,i)&&i!==t.container)||d!==e&&D.nodeContains(d,e))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;let n=s[this.id];if((r="first"in n?n.first:n.first=this.getFirst(!0))&&t.acceptCondition(r))return(t.rejectElementsFrom=d,t.skippedFocusable=!0,r!==t.from)?(t.found=!0,t.foundElement=r,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT}}}class ec{constructor(e,t){this._current={},this._grouppers={},this._init=()=>{let e=this._win();this._tabster.focusedElement.subscribeFirst(this._onFocus);let t=e.document,i=D.getActiveElement(t);i&&this._onFocus(i),t.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(v,this._onMoveFocus)},this._onGroupperDispose=e=>{delete this._grouppers[e.id]},this._onFocus=e=>{e&&this._updateCurrent(e)},this._onMouseDown=e=>{let t=e.target;for(;t&&!this._tabster.focusable.isFocusable(t);)t=this._tabster.getParent(t);t&&this._updateCurrent(t)},this._onKeyDown=e=>{if(e.key!==el.Enter&&e.key!==el.Escape||e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;let t=this._tabster.focusedElement.getFocusedElement();t&&this.handleKeyPress(t,e)},this._onMoveFocus=e=>{var t;let i=e.composedPath()[0],s=null==(t=e.detail)?void 0:t.action;i&&void 0!==s&&!e.defaultPrevented&&(s===c.Enter?this._enterGroupper(i):this._escapeGroupper(i),e.stopImmediatePropagation())},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){let e=this._win();this._tabster.focusedElement.cancelAsyncFocus(l.EscapeGroupper),this._current={},this._updateTimer&&(e.clearTimeout(this._updateTimer),delete this._updateTimer),this._tabster.focusedElement.unsubscribe(this._onFocus),e.document.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),e.removeEventListener(v,this._onMoveFocus),Object.keys(this._grouppers).forEach(e=>{this._grouppers[e]&&(this._grouppers[e].dispose(),delete this._grouppers[e])})}createGroupper(e,t,i){let s=this._tabster,r=new eh(s,e,this._onGroupperDispose,t,i);this._grouppers[r.id]=r;let n=s.focusedElement.getFocusedElement();return n&&D.nodeContains(e,n)&&!this._updateTimer&&(this._updateTimer=this._win().setTimeout(()=>{delete this._updateTimer,n===s.focusedElement.getFocusedElement()&&this._updateCurrent(n)},0)),r}forgetCurrentGrouppers(){this._current={}}_updateCurrent(e){var t;this._updateTimer&&(this._win().clearTimeout(this._updateTimer),delete this._updateTimer);let i=this._tabster,s={};for(let r=i.getParent(e);r;r=i.getParent(r)){let n=null==(t=_(i,r))?void 0:t.groupper;if(n){s[n.id]=!0,this._current[n.id]=n;let t=n.isActive()||e!==r&&(!n.getProps().delegated||n.getFirst(!1)!==e);n.makeTabbable(t)}}for(let e of Object.keys(this._current)){let t=this._current[e];t.id in s||(t.makeTabbable(!1),t.setFirst(void 0),delete this._current[e])}}_enterGroupper(e,t){let i=this._tabster,s=er.getTabsterContext(i,e),r=(null==s?void 0:s.groupper)||(null==s?void 0:s.modalizerInGroupper),n=null==r?void 0:r.getElement();if(r&&n&&(e===n||r.getProps().delegated&&e===r.getFirst(!1))){let s=i.focusable.findNext({container:n,currentElement:e,useActiveModalizer:!0});if(s&&(!t||t&&n.dispatchEvent(new T({by:"groupper",owner:n,next:s,relatedEvent:t}))))return t&&(t.preventDefault(),t.stopImmediatePropagation()),s.focus(),s}return null}_escapeGroupper(e,t,i){let s=this._tabster,r=er.getTabsterContext(s,e),n=(null==r?void 0:r.groupper)||(null==r?void 0:r.modalizerInGroupper),o=null==n?void 0:n.getElement();if(n&&o&&D.nodeContains(o,e)){let r;if(e!==o||i)r=n.getFirst(!0);else{let e=D.getParentElement(o),t=e?er.getTabsterContext(s,e):void 0;r=null==(n=null==t?void 0:t.groupper)?void 0:n.getFirst(!0)}if(r&&(!t||t&&o.dispatchEvent(new T({by:"groupper",owner:o,next:r,relatedEvent:t}))))return n&&n.makeTabbable(!1),r.focus(),r}return null}moveFocus(e,t){return t===c.Enter?this._enterGroupper(e):this._escapeGroupper(e)}handleKeyPress(e,t,i){let s=this._tabster,r=er.getTabsterContext(s,e);if(r&&((null==r?void 0:r.groupper)||(null==r?void 0:r.modalizerInGroupper))){if(s.focusedElement.cancelAsyncFocus(l.EscapeGroupper),r.ignoreKeydown(t))return;if(t.key===el.Enter)this._enterGroupper(e,t);else if(t.key===el.Escape){let r=s.focusedElement.getFocusedElement();s.focusedElement.requestAsyncFocus(l.EscapeGroupper,()=>{(r===s.focusedElement.getFocusedElement()||(!i||r)&&i)&&this._escapeGroupper(e,t,i)},0)}}}}class em extends en{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,r.SQ)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,r.bd)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(e){var t;null==(t=this._keyborg)||t.setVal(e)}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._keyborg)?void 0:e.isNavigatingWithKeyboard())}}class e_ extends q{constructor(e,t,i,s){super(t,e,J.Mover,s),this._onFocusDummyInput=e=>{var t,i;let s=this._element.get(),n=e.input;if(s&&n){let o,l=er.getTabsterContext(this._tabster,s);l&&(o=null==(t=eu.findNextTabbable(this._tabster,l,void 0,n,void 0,!e.isFirst,!0))?void 0:t.element);let a=null==(i=this._getMemorized())?void 0:i.get();a&&this._tabster.focusable.isFocusable(a)&&(o=a),o&&(0,r.kG)(o)}},this._tabster=t,this._getMemorized=i,this._setHandlers(this._onFocusDummyInput)}}class ef extends j{constructor(e,t,i,s,r){var n;super(e,t,s),this._visible={},this._onIntersection=e=>{for(let t of e){let e,i=t.target,s=U(this._win,i),r=this._fullyVisible;if(t.intersectionRatio>=.25?(e=t.intersectionRatio>=.75?a.Visible:a.PartiallyVisible)===a.Visible&&(r=s):e=a.Invisible,this._visible[s]!==e){void 0===e?(delete this._visible[s],r===s&&delete this._fullyVisible):(this._visible[s]=e,this._fullyVisible=r);let t=this.getState(i);t&&i.dispatchEvent(new F(t))}}},this._win=e.getWindow,this.visibilityTolerance=null!=(n=s.visibilityTolerance)?n:.8,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=i;let o=()=>s.memorizeCurrent?this._current:void 0;e.controlTab||(this.dummyManager=new e_(this._element,e,o,r))}dispose(){var e;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);let t=this._win();this._setCurrentTimer&&(t.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(t.clearTimeout(this._updateTimer),delete this._updateTimer),null==(e=this.dummyManager)||e.dispose(),delete this.dummyManager}setCurrent(e){e?this._current=new A(this._win,e):this._current=void 0,(this._props.trackState||this._props.visibilityAware)&&!this._setCurrentTimer&&(this._setCurrentTimer=this._win().setTimeout(()=>{var e;delete this._setCurrentTimer;let t=[];for(let i of(this._current!==this._prevCurrent&&(t.push(this._current),t.push(this._prevCurrent),this._prevCurrent=this._current),t)){let t=null==i?void 0:i.get();if(t&&(null==(e=this._allElements)?void 0:e.get(t))===this){let e=this._props;if(t&&(void 0!==e.visibilityAware||e.trackState)){let e=this.getState(t);e&&t.dispatchEvent(new F(e))}}}}))}getCurrent(){var e;return(null==(e=this._current)?void 0:e.get())||null}findNextTabbable(e,t,i,s){let r,n=this.getElement(),o=n&&ee(e)===n;if(!n)return null;let l=null,a=!1;if(this._props.tabbable||o||e&&!D.nodeContains(n,e)){let o={};l=this._tabster.focusable[i?"findPrev":"findNext"]({currentElement:e,referenceElement:t,container:n,ignoreAccessibility:s,useActiveModalizer:!0},o),a=!!o.outOfDOMOrder,r=o.uncontrolled}return{element:l,uncontrolled:r,outOfDOMOrder:a}}acceptElement(e,t){var i,s;if(!eu.isTabbing)return(null==(i=t.currentCtx)?void 0:i.excludedFromMover)?NodeFilter.FILTER_REJECT:void 0;let{memorizeCurrent:r,visibilityAware:n,hasDefault:o=!0}=this._props,l=this.getElement();if(l&&(r||n||o)&&(!D.nodeContains(l,t.from)||ee(t.from)===l)){let e;if(r){let i=null==(s=this._current)?void 0:s.get();i&&t.acceptCondition(i)&&(e=i)}if(!e&&o&&(e=this._tabster.focusable.findDefault({container:l,useActiveModalizer:!0})),!e&&n&&(e=this._tabster.focusable.findElement({container:l,useActiveModalizer:!0,isBackward:t.isBackward,acceptCondition:e=>{var i;let s=U(this._win,e),r=this._visible[s];return l!==e&&!!(null==(i=this._allElements)?void 0:i.get(e))&&t.acceptCondition(e)&&(r===a.Visible||r===a.PartiallyVisible&&(n===a.PartiallyVisible||!this._fullyVisible))}})),e)return t.found=!0,t.foundElement=e,t.rejectElementsFrom=l,t.skippedFocusable=!0,NodeFilter.FILTER_ACCEPT}}_observeState(){let e=this.getElement();if(this._unobserve||!e||"undefined"==typeof MutationObserver)return;let t=this._win(),i=this._allElements=new WeakMap,s=this._tabster.focusable,r=this._updateQueue=[],n=D.createMutationObserver(e=>{for(let t of e){let e=t.target,i=t.removedNodes,s=t.addedNodes;if("attributes"===t.type)"tabindex"===t.attributeName&&r.push({element:e,type:2});else{for(let e=0;e<i.length;e++)r.push({element:i[e],type:3});for(let e=0;e<s.length;e++)r.push({element:s[e],type:1})}}d()}),o=(e,t)=>{var s,r;let n=i.get(e);n&&t&&(null==(s=this._intersectionObserver)||s.unobserve(e),i.delete(e)),n||t||(i.set(e,this),null==(r=this._intersectionObserver)||r.observe(e))},l=e=>{let t=s.isFocusable(e);i.get(e)?t||o(e,!0):t&&o(e)},a=e=>{let{mover:i}=h(e);if(i&&i!==this)if(!(i.getElement()===e&&s.isFocusable(e)))return;else o(e);let r=L(t.document,e,e=>{let{mover:t,groupper:i}=h(e);if(t&&t!==this)return NodeFilter.FILTER_REJECT;let r=null==i?void 0:i.getFirst(!0);return i&&i.getElement()!==e&&r&&r!==e?NodeFilter.FILTER_REJECT:(s.isFocusable(e)&&o(e),NodeFilter.FILTER_SKIP)});if(r)for(r.currentNode=e;r.nextNode(););},u=e=>{i.get(e)&&o(e,!0);for(let t=D.getFirstElementChild(e);t;t=D.getNextElementSibling(t))u(t)},d=()=>{!this._updateTimer&&r.length&&(this._updateTimer=t.setTimeout(()=>{for(let{element:e,type:t}of(delete this._updateTimer,r))switch(t){case 2:l(e);break;case 1:a(e);break;case 3:u(e)}r=this._updateQueue=[]},0))},h=e=>{let t={};for(let i=e;i;i=D.getParentElement(i)){let e=_(this._tabster,i);if(e&&(e.groupper&&!t.groupper&&(t.groupper=e.groupper),e.mover)){t.mover=e.mover;break}}return t};r.push({element:e,type:1}),d(),n.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{n.disconnect()}}getState(e){let t=U(this._win,e);if(t in this._visible){let i=this._visible[t]||a.Invisible;return{isCurrent:this._current?this._current.get()===e:void 0,visibility:i}}}}class eb{constructor(e,t){this._init=()=>{let e=this._win();e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(b,this._onMoveFocus),e.addEventListener(p,this._onMemorizedElement),this._tabster.focusedElement.subscribe(this._onFocus)},this._onMoverDispose=e=>{delete this._movers[e.id]},this._onFocus=e=>{var t;let i=e,s=e;for(let r=D.getParentElement(e);r;r=D.getParentElement(r)){let e=null==(t=_(this._tabster,r))?void 0:t.mover;e&&(e.setCurrent(s),i=void 0),!i&&this._tabster.focusable.isFocusable(r)&&(i=s=r)}},this._onKeyDown=async e=>{var t;let i;if(this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null==(t=this._ignoredInputResolve)||t.call(this,!1),e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;let s=e.key;if(s===el.ArrowDown?i=d.ArrowDown:s===el.ArrowRight?i=d.ArrowRight:s===el.ArrowUp?i=d.ArrowUp:s===el.ArrowLeft?i=d.ArrowLeft:s===el.PageDown?i=d.PageDown:s===el.PageUp?i=d.PageUp:s===el.Home?i=d.Home:s===el.End&&(i=d.End),!i)return;let r=this._tabster.focusedElement.getFocusedElement();!r||await this._isIgnoredInput(r,s)||this._moveFocus(r,i,e)},this._onMoveFocus=e=>{var t;let i=e.composedPath()[0],s=null==(t=e.detail)?void 0:t.key;i&&void 0!==s&&!e.defaultPrevented&&(this._moveFocus(i,s),e.stopImmediatePropagation())},this._onMemorizedElement=e=>{var t;let i=e.composedPath()[0],s=null==(t=e.detail)?void 0:t.memorizedElement;if(i){let t=er.getTabsterContext(this._tabster,i),r=null==t?void 0:t.mover;r&&(s&&!D.nodeContains(r.getElement(),s)&&(s=void 0),r.setCurrent(s),e.stopImmediatePropagation())}},this._tabster=e,this._win=t,this._movers={},e.queueInit(this._init)}dispose(){var e;let t=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),null==(e=this._ignoredInputResolve)||e.call(this,!1),this._ignoredInputTimer&&(t.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener(b,this._onMoveFocus),t.removeEventListener(p,this._onMemorizedElement),Object.keys(this._movers).forEach(e=>{this._movers[e]&&(this._movers[e].dispose(),delete this._movers[e])})}createMover(e,t,i){let s=new ef(this._tabster,e,this._onMoverDispose,t,i);return this._movers[s.id]=s,s}moveFocus(e,t){return this._moveFocus(e,t)}_moveFocus(e,t,i){var s,n;let o,l,a,h=this._tabster,c=er.getTabsterContext(h,e,{checkRtl:!0});if(!c||!c.mover||c.excludedFromMover||i&&c.ignoreKeydown(i))return null;let m=c.mover,f=m.getElement();if(c.groupperBeforeMover){let e=c.groupper;if(!e||e.isActive(!0))return null;for(let t=D.getParentElement(e.getElement());t&&t!==f;t=D.getParentElement(t))if(null==(n=null==(s=_(h,t))?void 0:s.groupper)?void 0:n.isActive(!0))return null}if(!f)return null;let b=h.focusable,p=m.getProps(),v=p.direction||u.Both,g=v===u.Both,E=g||v===u.Vertical,w=g||v===u.Horizontal,y=v===u.GridLinear,F=y||v===u.Grid,C=p.cyclic,k=0,I=0;if(F&&(k=Math.ceil((a=e.getBoundingClientRect()).left),I=Math.floor(a.right)),c.rtl&&(t===d.ArrowRight?t=d.ArrowLeft:t===d.ArrowLeft&&(t=d.ArrowRight)),t===d.ArrowDown&&E||t===d.ArrowRight&&(w||F))if((o=b.findNext({currentElement:e,container:f,useActiveModalizer:!0}))&&F){let e=Math.ceil(o.getBoundingClientRect().left);!y&&I>e&&(o=void 0)}else!o&&C&&(o=b.findFirst({container:f,useActiveModalizer:!0}));else if(t===d.ArrowUp&&E||t===d.ArrowLeft&&(w||F))if((o=b.findPrev({currentElement:e,container:f,useActiveModalizer:!0}))&&F){let e=Math.floor(o.getBoundingClientRect().right);!y&&e>k&&(o=void 0)}else!o&&C&&(o=b.findLast({container:f,useActiveModalizer:!0}));else if(t===d.Home)F?b.findElement({container:f,currentElement:e,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{var i;if(!b.isFocusable(t))return!1;let s=Math.ceil(null!=(i=t.getBoundingClientRect().left)?i:0);return t!==e&&k<=s||(o=t,!1)}}):o=b.findFirst({container:f,useActiveModalizer:!0});else if(t===d.End)F?b.findElement({container:f,currentElement:e,useActiveModalizer:!0,acceptCondition:t=>{var i;if(!b.isFocusable(t))return!1;let s=Math.ceil(null!=(i=t.getBoundingClientRect().left)?i:0);return t!==e&&k>=s||(o=t,!1)}}):o=b.findLast({container:f,useActiveModalizer:!0});else if(t===d.PageUp){if(b.findElement({currentElement:e,container:f,useActiveModalizer:!0,isBackward:!0,acceptCondition:e=>!!b.isFocusable(e)&&(!S(this._win,e,m.visibilityTolerance)||(o=e,!1))}),F&&o){let e=Math.ceil(o.getBoundingClientRect().left);b.findElement({currentElement:o,container:f,useActiveModalizer:!0,acceptCondition:t=>{if(!b.isFocusable(t))return!1;let i=Math.ceil(t.getBoundingClientRect().left);return k<i||e>=i||(o=t,!1)}})}l=!1}else if(t===d.PageDown){if(b.findElement({currentElement:e,container:f,useActiveModalizer:!0,acceptCondition:e=>!!b.isFocusable(e)&&(!S(this._win,e,m.visibilityTolerance)||(o=e,!1))}),F&&o){let e=Math.ceil(o.getBoundingClientRect().left);b.findElement({currentElement:o,container:f,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{if(!b.isFocusable(t))return!1;let i=Math.ceil(t.getBoundingClientRect().left);return k>i||e<=i||(o=t,!1)}})}l=!0}else if(F){let i,s,r=t===d.ArrowUp,n=k,l=Math.ceil(a.top),u=I,h=Math.floor(a.bottom),c=0;b.findAll({container:f,currentElement:e,isBackward:r,onElement:e=>{let t=e.getBoundingClientRect(),o=Math.ceil(t.left),a=Math.ceil(t.top),d=Math.floor(t.right),m=Math.floor(t.bottom);if(r&&l<m||!r&&h>a)return!0;let _=Math.ceil(Math.min(u,d))-Math.floor(Math.max(n,o)),f=Math.ceil(Math.min(u-n,d-o));if(_>0&&f>=_){let t=_/f;t>c&&(i=e,c=t)}else if(0===c){let t=function(e,t,i,s,r,n,o,l){let a=i<r?r-i:o<e?e-o:0,u=s<n?n-s:l<t?t-l:0;return 0===a?u:0===u?a:Math.sqrt(a*a+u*u)}(n,l,u,h,o,a,d,m);(void 0===s||t<s)&&(s=t,i=e)}else if(c>0)return!1;return!0}}),o=i}return o&&(!i||i&&f.dispatchEvent(new T({by:"mover",owner:f,next:o,relatedEvent:i})))?(void 0!==l&&function(e,t,i){let s=B(t);if(s){let r=W(e,s),n=t.getBoundingClientRect();i?s.scrollTop+=n.top-r.top:s.scrollTop+=n.bottom-r.bottom}}(this._win,o,l),i&&(i.preventDefault(),i.stopImmediatePropagation()),(0,r.kG)(o),o):null}async _isIgnoredInput(e,t){if("true"===e.getAttribute("aria-expanded")&&e.hasAttribute("aria-activedescendant"))return!0;if(K(e,"input, textarea, *[contenteditable]")){let i,s=0,r=0,n=0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){let i=e.type;if(n=(e.value||"").length,"email"===i||"number"===i){if(n){let i=D.getSelection(e);if(i){let e=i.toString().length,s=t===el.ArrowLeft||t===el.ArrowUp;if(i.modify("extend",s?"backward":"forward","character"),e!==i.toString().length)return i.modify("extend",s?"forward":"backward","character"),!0;n=0}}}else{let t=e.selectionStart;if(null===t)return"hidden"===i;s=t||0,r=e.selectionEnd||0}}else"true"===e.contentEditable&&(i=new(function(e){let t=M(e);if(t.basics.Promise)return t.basics.Promise;throw Error("No Promise defined.")}(this._win))(t=>{this._ignoredInputResolve=e=>{delete this._ignoredInputResolve,t(e)};let i=this._win();this._ignoredInputTimer&&i.clearTimeout(this._ignoredInputTimer);let{anchorNode:o,focusNode:l,anchorOffset:a,focusOffset:u}=D.getSelection(e)||{};this._ignoredInputTimer=i.setTimeout(()=>{var t,i,d;delete this._ignoredInputTimer;let{anchorNode:h,focusNode:c,anchorOffset:m,focusOffset:_}=D.getSelection(e)||{};if(h!==o||c!==l||m!==a||_!==u){null==(t=this._ignoredInputResolve)||t.call(this,!1);return}if(s=m||0,r=_||0,n=(null==(i=e.textContent)?void 0:i.length)||0,h&&c&&D.nodeContains(e,h)&&D.nodeContains(e,c)&&h!==e){let t=!1,i=e=>{if(e===h)t=!0;else if(e===c)return!0;let n=e.textContent;if(n&&!D.getFirstChild(e)){let e=n.length;t?c!==h&&(r+=e):(s+=e,r+=e)}let o=!1;for(let t=D.getFirstChild(e);t&&!o;t=t.nextSibling)o=i(t);return o};i(e)}null==(d=this._ignoredInputResolve)||d.call(this,!0)},0)}));if(i&&!await i||s!==r||s>0&&(t===el.ArrowLeft||t===el.ArrowUp||t===el.Home)||s<n&&(t===el.ArrowRight||t===el.ArrowDown||t===el.End))return!0}return!1}}class ep{constructor(e){this._isUncontrolledCompletely=e}isUncontrolledCompletely(e,t){var i;let s=null==(i=this._isUncontrolledCompletely)?void 0:i.call(this,e,t);return void 0===s?t:s}}class ev{constructor(e){this._stack=[],this._getWindow=e}push(e){var t;(null==(t=this._stack[this._stack.length-1])?void 0:t.get())!==e&&(this._stack.length>ev.DEPTH&&this._stack.shift(),this._stack.push(new A(this._getWindow,e)))}pop(e){var t;void 0===e&&(e=()=>!0);let i=this._getWindow().document;for(let s=this._stack.length-1;s>=0;s--){let s=null==(t=this._stack.pop())?void 0:t.get();if(s&&D.nodeContains(i.body,D.getParentElement(s))&&e(s))return s}}}function eg(e,t){var i,s;if(!e||!t)return!1;let r=t;for(;r;){if(r===e)return!0;r="function"!=typeof r.assignedElements&&(null==(i=r.assignedSlot)?void 0:i.parentNode)?null==(s=r.assignedSlot)?void 0:s.parentNode:r.nodeType===document.DOCUMENT_FRAGMENT_NODE?r.host:r.parentNode}return!1}ev.DEPTH=10;class eE{static _overrideAttachShadow(e){let t=e.Element.prototype.attachShadow;t.__origAttachShadow||(Element.prototype.attachShadow=function(e){let i=t.call(this,e);for(let e of eE._shadowObservers)e._addSubObserver(i);return i},Element.prototype.attachShadow.__origAttachShadow=t)}constructor(e){this._isObserving=!1,this._callbackWrapper=(e,t)=>{for(let t of e)if("childList"===t.type){let e=t.removedNodes,i=t.addedNodes;for(let t=0;t<e.length;t++)this._walkShadows(e[t],!0);for(let e=0;e<i.length;e++)this._walkShadows(i[e])}this._callback(e,t)},this._callback=e,this._observer=new MutationObserver(this._callbackWrapper),this._subObservers=new Map}_addSubObserver(e){if(!(!this._options||!this._callback||this._subObservers.has(e))&&this._options.subtree&&eg(this._root,e)){let t=new MutationObserver(this._callbackWrapper);this._subObservers.set(e,t),this._isObserving&&t.observe(e,this._options),this._walkShadows(e)}}disconnect(){for(let e of(this._isObserving=!1,delete this._options,eE._shadowObservers.delete(this),this._subObservers.values()))e.disconnect();this._subObservers.clear(),this._observer.disconnect()}observe(e,t){let i=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument,s=null==i?void 0:i.defaultView;i&&s&&(eE._overrideAttachShadow(s),eE._shadowObservers.add(this),this._root=e,this._options=t,this._isObserving=!0,this._observer.observe(e,t),this._walkShadows(e))}_walkShadows(e,t){let i=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument;if(i){if(e===i)e=i.body;else{let t=e.shadowRoot;if(t)return void this._addSubObserver(t)}i.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{if(e.nodeType===Node.ELEMENT_NODE)if(t){let t=this._subObservers.get(e);t&&(t.disconnect(),this._subObservers.delete(e))}else{let t=e.shadowRoot;t&&this._addSubObserver(t)}return NodeFilter.FILTER_SKIP}}).nextNode()}}takeRecords(){let e=this._observer.takeRecords();for(let t of this._subObservers.values())e.push(...t.takeRecords());return e}}eE._shadowObservers=new Set;class ew{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}}class ey{constructor(e,t){var i,s;this._forgetMemorizedElements=[],this._wrappers=new Set,this._initQueue=[],this._version="8.5.6",this._noop=!1,this.getWindow=()=>{if(!this._win)throw Error("Using disposed Tabster.");return this._win},this._storage=function(e){let t=e.__tabsterInstanceContext;return new((null==t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;let r=this.getWindow;(null==t?void 0:t.DOMAPI)&&function(e){for(let t of Object.keys(e))D[t]=e[t]}({...t.DOMAPI}),this.keyboardNavigation=new em(r),this.focusedElement=new eu(this,r),this.focusable=new eo(this),this.root=new er(this,null==t?void 0:t.autoRoot),this.uncontrolled=new ep((null==t?void 0:t.checkUncontrolledCompletely)||(null==t?void 0:t.checkUncontrolledTrappingFocus)),this.controlTab=null==(i=null==t?void 0:t.controlTab)||i,this.rootDummyInputs=!!(null==t?void 0:t.rootDummyInputs),this._dummyObserver=new Y(r),this.getParent=null!=(s=null==t?void 0:t.getParent)?s:D.getParentNode,this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){let t=r().document;this._unobserve=function(e,t,i,s){let r;if("undefined"==typeof MutationObserver)return()=>{};let o=t.getWindow;function l(t,i){r||(r=M(o).elementByUId),a(t,i);let s=L(e,t,e=>a(e,i));if(s)for(;s.nextNode(););}function a(e,s){if(!e.getAttribute)return NodeFilter.FILTER_SKIP;let l=e.__tabsterElementUID;return l&&r&&(s?delete r[l]:null!=r[l]||(r[l]=new A(o,e))),(_(t,e)||e.hasAttribute(n))&&i(t,e,s),NodeFilter.FILTER_SKIP}let u=D.createMutationObserver(e=>{var s,r,o,a,u;let d=new Set;for(let u of e){let e=u.target,h=u.removedNodes,c=u.addedNodes;if("attributes"===u.type)u.attributeName!==n||d.has(e)||i(t,e);else{for(let i=0;i<h.length;i++){let n=h[i];d.add(n),l(n,!0),null==(r=(s=t._dummyObserver).domChanged)||r.call(s,e)}for(let i=0;i<c.length;i++)l(c[i]),null==(a=(o=t._dummyObserver).domChanged)||a.call(o,e)}}d.clear(),null==(u=t.modalizer)||u.hiddenUpdate()});return s&&l(o().document.body),u.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[n]}),()=>{u.disconnect()}}(t,this,f,e)}}},function e(t){let i=M(t);i.fakeWeakRefsStarted||(i.fakeWeakRefsStarted=!0,i.WeakRef=i.basics.WeakRef),i.fakeWeakRefsTimer||(i.fakeWeakRefsTimer=t().setTimeout(()=>{i.fakeWeakRefsTimer=void 0,x(t),e(t)},12e4))}(r),this.queueInit(()=>{this.internal.resumeObserver(!0)})}_mergeProps(e){var t;e&&(this.getParent=null!=(t=e.getParent)?t:this.getParent)}createTabster(e,t){let i=new ew(this);return e||this._wrappers.add(i),this._mergeProps(t),i}disposeTabster(e,t){t?this._wrappers.clear():this._wrappers.delete(e),0===this._wrappers.size&&this.dispose()}dispose(){this.internal.stopObserver();let e=this._win;null==e||e.clearTimeout(this._initTimer),delete this._initTimer,this._initQueue=[],this._forgetMemorizedElements=[],e&&this._forgetMemorizedTimer&&(e.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null==(t=this.outline)||t.dispose(),null==(i=this.crossOrigin)||i.dispose(),null==(s=this.deloser)||s.dispose(),null==(r=this.groupper)||r.dispose(),null==(n=this.mover)||n.dispose(),null==(o=this.modalizer)||o.dispose(),null==(l=this.observedElement)||l.dispose(),null==(a=this.restorer)||a.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose();var t,i,s,r,n,o,l,a,u=this.getWindow;let d=M(u);if(d.fakeWeakRefsStarted=!1,d.fakeWeakRefsTimer&&(u().clearTimeout(d.fakeWeakRefsTimer),d.fakeWeakRefsTimer=void 0,d.fakeWeakRefs=[]),V(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),e){let t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext),delete e.__tabsterInstance,delete this._win}}storageEntry(e,t){let i=this._storage,s=i.get(e);return s?!1===t&&0===Object.keys(s).length&&i.delete(e):!0===t&&(s={},i.set(e,s)),s}forceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout(()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())V(this.getWindow,e),eu.forgetMemorized(this.focusedElement,e)},0),x(this.getWindow,!0)))}queueInit(e){var t;this._win&&(this._initQueue.push(e),this._initTimer||(this._initTimer=null==(t=this._win)?void 0:t.setTimeout(()=>{delete this._initTimer,this.drainInitQueue()},0)))}drainInitQueue(){if(!this._win)return;let e=this._initQueue;this._initQueue=[],e.forEach(e=>e())}}function eT(e,t){let i=e.__tabsterInstance;return i?i.createTabster(!1,t):(i=new ey(e,t),e.__tabsterInstance=i,i.createTabster())}function eF(e){let t=e.core;return t.groupper||(t.groupper=new ec(t,t.getWindow)),t.groupper}function eC(e){let t=e.core;return t.mover||(t.mover=new eb(t,t.getWindow)),t.mover}function ek(e,t){e.core.disposeTabster(e,t)}}}]);